// File Line: 46
// RVA: 0x155A240
__int64 UFG::_dynamic_initializer_for__meter_critical_gunshot_volume__()
{
  meter_critical_gunshot_volume.mUID = UFG::qWiseSymbolUIDFromString("meter_critical_gunshot_volume", 0x811C9DC5);
  _((AMD_HD3D *)meter_critical_gunshot_volume.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__meter_critical_gunshot_volume__);
}

// File Line: 47
// RVA: 0x155D060
__int64 UFG::_dynamic_initializer_for__stop_gunshot_loop_p__()
{
  stop_gunshot_loop_p.mUID = UFG::qWiseSymbolUIDFromString("stop_gunshot_loop_p", 0x811C9DC5);
  _((AMD_HD3D *)stop_gunshot_loop_p.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__stop_gunshot_loop_p__);
}

// File Line: 48
// RVA: 0x155D010
__int64 UFG::_dynamic_initializer_for__stop_gunshot_loop_ai__()
{
  stop_gunshot_loop_ai.mUID = UFG::qWiseSymbolUIDFromString("stop_gunshot_loop_ai", 0x811C9DC5);
  _((AMD_HD3D *)stop_gunshot_loop_ai.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__stop_gunshot_loop_ai__);
}

// File Line: 49
// RVA: 0x155A9F0
__int64 UFG::_dynamic_initializer_for__play_gunshot_tail_p__()
{
  play_gunshot_tail_p.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot_tail_p", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_tail_p.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot_tail_p__);
}

// File Line: 50
// RVA: 0x155A9A0
__int64 UFG::_dynamic_initializer_for__play_gunshot_tail_ai__()
{
  play_gunshot_tail_ai.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot_tail_ai", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_tail_ai.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot_tail_ai__);
}

// File Line: 51
// RVA: 0x155A810
__int64 UFG::_dynamic_initializer_for__play_gunshot__()
{
  play_gunshot_0.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_0.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot__);
}

// File Line: 52
// RVA: 0x155A860
__int64 UFG::_dynamic_initializer_for__play_gunshot_loop_ai__()
{
  play_gunshot_loop_ai.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot_loop_ai", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_loop_ai.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot_loop_ai__);
}

// File Line: 53
// RVA: 0x155A8B0
__int64 UFG::_dynamic_initializer_for__play_gunshot_loop_p__()
{
  play_gunshot_loop_p.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot_loop_p", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_loop_p.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot_loop_p__);
}

// File Line: 54
// RVA: 0x155A900
__int64 UFG::_dynamic_initializer_for__play_gunshot_single_ai__()
{
  play_gunshot_single_ai.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot_single_ai", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_single_ai.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot_single_ai__);
}

// File Line: 55
// RVA: 0x155A950
__int64 UFG::_dynamic_initializer_for__play_gunshot_single_p__()
{
  play_gunshot_single_p.mUID = UFG::qWiseSymbolUIDFromString("play_gunshot_single_p", 0x811C9DC5);
  _((AMD_HD3D *)play_gunshot_single_p.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__play_gunshot_single_p__);
}

// File Line: 56
// RVA: 0x155CE80
__int64 UFG::_dynamic_initializer_for__shot_loop_duration__()
{
  shot_loop_duration.mUID = UFG::qWiseSymbolUIDFromString("shot_loop_duration", 0x811C9DC5);
  _((AMD_HD3D *)shot_loop_duration.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__shot_loop_duration__);
}

// File Line: 58
// RVA: 0x155AE00
__int64 UFG::_dynamic_initializer_for__player__()
{
  player.mUID = UFG::qWiseSymbolUIDFromString("player", 0x811C9DC5);
  _((AMD_HD3D *)player.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__player__);
}

// File Line: 59
// RVA: 0x1559870
__int64 UFG::_dynamic_initializer_for__ai__()
{
  ai.mUID = UFG::qWiseSymbolUIDFromString("ai", 0x811C9DC5);
  _((AMD_HD3D *)ai.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__ai__);
}

// File Line: 60
// RVA: 0x155D370
__int64 UFG::_dynamic_initializer_for__weapon_owner_type__()
{
  weapon_owner_type.mUID = UFG::qWiseSymbolUIDFromString("weapon_owner_type", 0x811C9DC5);
  _((AMD_HD3D *)weapon_owner_type.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__weapon_owner_type__);
}

// File Line: 61
// RVA: 0x155D3C0
__int64 UFG::_dynamic_initializer_for__weapon_type__()
{
  weapon_type.mUID = UFG::qWiseSymbolUIDFromString("weapon_type", 0x811C9DC5);
  _((AMD_HD3D *)weapon_type.mUID);
  return atexit(UFG::_dynamic_atexit_destructor_for__weapon_type__);
}

// File Line: 71
// RVA: 0x594610
void __fastcall UFG::GunshotManagerGunInfo::~GunshotManagerGunInfo(UFG::GunshotManagerGunInfo *this)
{
  UFG::GunshotManagerGunInfo *v1; // r8
  UFG::qSafePointer<UFG::SimObject,UFG::SimObject> *v2; // rdx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v3; // rcx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v4; // rax
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v5; // rcx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v6; // rax
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v7; // rdx
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v8; // rcx
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v9; // rax

  v1 = this;
  this->vfptr = (UFG::GunshotManagerGunInfoVtbl *)&UFG::GunshotManagerGunInfo::`vftable';
  v2 = &this->simObject;
  if ( this->simObject.m_pPointer )
  {
    v3 = v2->mPrev;
    v4 = v2->mNext;
    v3->mNext = v4;
    v4->mPrev = v3;
    v2->mPrev = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v2->mPrev;
    v2->mNext = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v2->mPrev;
  }
  v2->m_pPointer = 0i64;
  v5 = v2->mPrev;
  v6 = v2->mNext;
  v5->mNext = v6;
  v6->mPrev = v5;
  v2->mPrev = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v2->mPrev;
  v2->mNext = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v2->mPrev;
  v7 = (UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *)&v1->mPrev;
  v8 = v1->mPrev;
  v9 = v1->mNext;
  v8->mNext = v9;
  v9->mPrev = v8;
  v7->mPrev = v7;
  v7->mNext = v7;
}

// File Line: 77
// RVA: 0x59F620
void __fastcall UFG::GunshotManagerGunInfo::Init(UFG::GunshotManagerGunInfo *this, UFG::SimObject *pSimObject)
{
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v2; // r9
  UFG::GunshotManagerGunInfo *v3; // rdi
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v4; // r8
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v5; // rax
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v6; // rax
  UFG::SimObject *v7; // rcx
  UFG::InventoryItemComponent *v8; // rax
  UFG::SimObjectCharacter *v9; // rbx
  UFG::SimObject *v10; // rax
  UFG::SimObjectProp *v11; // rcx
  unsigned __int16 v12; // dx
  UFG::SimObjectWeaponPropertiesComponent *v13; // rax

  v2 = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&this->simObject.mPrev;
  v3 = this;
  if ( this->simObject.m_pPointer )
  {
    v4 = v2->mPrev;
    v5 = this->simObject.mNext;
    v4->mNext = v5;
    v5->mPrev = v4;
    v2->mPrev = v2;
    this->simObject.mNext = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&this->simObject.mPrev;
  }
  this->simObject.m_pPointer = pSimObject;
  if ( pSimObject )
  {
    v6 = pSimObject->m_SafePointerList.mNode.mPrev;
    v6->mNext = v2;
    v2->mPrev = v6;
    this->simObject.mNext = &pSimObject->m_SafePointerList.mNode;
    pSimObject->m_SafePointerList.mNode.mPrev = v2;
  }
  v7 = this->simObject.m_pPointer;
  *(_WORD *)&v3->hasInventory = 0;
  v3->rateOfFire = 0.0;
  v3->isPlayer = 0;
  v3->numContinuousShotsFired = 0;
  *(_QWORD *)&v3->fireMode = 0i64;
  if ( v7 )
  {
    v8 = (UFG::InventoryItemComponent *)UFG::SimObject::GetComponentOfType(v7, UFG::InventoryItemComponent::_TypeUID);
    if ( v8 )
    {
      v3->hasInventory = 1;
      v9 = LocalPlayer;
      v10 = UFG::InventoryItemComponent::GetOwnerSimObject(v8);
      v11 = (UFG::SimObjectProp *)v3->simObject.m_pPointer;
      v3->isPlayer = v10 == (UFG::SimObject *)v9;
      if ( v11->m_pSceneObj )
      {
        v3->hasSceneObjectProperties = 1;
        if ( v11 )
        {
          v12 = v11->m_Flags;
          if ( (v12 >> 14) & 1 )
          {
            v13 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                               (UFG::SimObjectGame *)&v11->vfptr,
                                                               UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
          }
          else if ( (v12 & 0x8000u) == 0 )
          {
            if ( (v12 >> 13) & 1 )
            {
              v13 = UFG::SimObjectProp::GetComponent<UFG::SimObjectWeaponPropertiesComponent>(v11);
            }
            else if ( (v12 >> 12) & 1 )
            {
              v13 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                                 (UFG::SimObjectGame *)&v11->vfptr,
                                                                 UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
            }
            else
            {
              v13 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObject::GetComponentOfType(
                                                                 (UFG::SimObject *)&v11->vfptr,
                                                                 UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
            }
          }
          else
          {
            v13 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                               (UFG::SimObjectGame *)&v11->vfptr,
                                                               UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
          }
          if ( v13 )
          {
            v3->rateOfFire = v13->mWeaponTypeInfo->mFireModes[v13->mFireMode]->mRateOfFire;
            v3->fireMode = v13->mFireMode;
          }
        }
      }
    }
  }
}Fire;
         

// File Line: 121
// RVA: 0x1559CC0
__int64 UFG::_dynamic_initializer_for__gGunshotRequestPool__()
{
  UFG::qFixedAllocator::qFixedAllocator(&UFG::gGunshotRequestPool);
  return atexit(UFG::_dynamic_atexit_destructor_for__gGunshotRequestPool__);
}

// File Line: 124
// RVA: 0x155A3A0
signed __int64 UFG::_dynamic_initializer_for__num_distant_gunshots__()
{
  signed __int64 result; // rax

  result = UFG::TiDo::CalcWwiseUid("num_distant_gunshots");
  num_distant_gunshots = result;
  return result;
}

// File Line: 125
// RVA: 0x155A380
signed __int64 UFG::_dynamic_initializer_for__num_ai_gunshots__()
{
  signed __int64 result; // rax

  result = UFG::TiDo::CalcWwiseUid("num_ai_gunshots");
  num_ai_gunshots = result;
  return result;
}

// File Line: 126
// RVA: 0x1559A70
signed __int64 UFG::_dynamic_initializer_for__critical_gunshot_volume__()
{
  signed __int64 result; // rax

  result = UFG::TiDo::CalcWwiseUid("critical_gunshot_volume");
  critical_gunshot_volume = result;
  return result;
}

// File Line: 175
// RVA: 0x59D090
UFG::GunshotManager *__fastcall UFG::GunshotManager::GetInstance()
{
  return UFG::GunshotManager::ms_instance;
}

// File Line: 181
// RVA: 0x5AA130
void __fastcall UFG::GunshotManager::RequestShotStart(UFG::GunshotManager *this, unsigned int soundId, UFG::SimObject *simObject)
{
  UFG::SimObject *v3; // rdi
  unsigned int v4; // er14
  UFG::GunshotManager *v5; // rbp
  UFG::GunshotManagerGunInfo *v6; // rbx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **v7; // rcx
  UFG::SimObjectWeaponPropertiesComponent *v8; // rax
  unsigned __int16 v9; // cx
  UFG::allocator::free_link *v10; // rax
  UFG::allocator::free_link *v11; // rax
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v12; // rdx
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v13; // rax
  char *v14; // rbx
  unsigned int v15; // eax
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v16; // rdx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v17; // rcx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v18; // rax
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v19; // rax
  float v20; // xmm0_4
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v21; // rcx
  char **v22; // rax
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v23; // rax
  UFG::qSafePointer<UFG::SimObject,UFG::SimObject> *v24; // [rsp+68h] [rbp+20h]
  _QWORD *v25; // [rsp+68h] [rbp+20h]

  v3 = simObject;
  v4 = soundId;
  v5 = this;
  v6 = (UFG::GunshotManagerGunInfo *)&this->m_gunInfoList.mNode.mNext[-1].mNext;
  v7 = &this->m_activeRequests.mNode.mNext;
  if ( v6 == (UFG::GunshotManagerGunInfo *)v7 )
  {
LABEL_18:
    v10 = UFG::qMalloc(0x48ui64, UFG::gGlobalNewName, 0i64);
    v6 = (UFG::GunshotManagerGunInfo *)v10;
    if ( v10 )
    {
      v11 = v10 + 1;
      v11->mNext = v11;
      v11[1].mNext = v11;
      v6->vfptr = (UFG::GunshotManagerGunInfoVtbl *)&UFG::GunshotManagerGunInfo::`vftable';
      v24 = &v6->simObject;
      v24->mPrev = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v24->mPrev;
      v24->mNext = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v24->mPrev;
      v6->simObject.m_pPointer = 0i64;
      UFG::GunshotManagerGunInfo::Init(v6, v3);
    }
    else
    {
      v6 = 0i64;
    }
    v12 = (UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *)&v6->mPrev;
    v13 = v5->m_gunInfoList.mNode.mNext;
    v5->m_gunInfoList.mNode.mNext = (UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *)&v6->mPrev;
    v12->mPrev = &v5->m_gunInfoList.mNode;
    v12->mNext = v13;
    v13->mPrev = (UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *)&v6->mPrev;
  }
  else
  {
    while ( simObject != v6->simObject.m_pPointer )
    {
      v6 = (UFG::GunshotManagerGunInfo *)&v6->mNext[-1].mNext;
      if ( v6 == (UFG::GunshotManagerGunInfo *)v7 )
        goto LABEL_18;
    }
    if ( simObject )
    {
      v9 = simObject->m_Flags;
      if ( (v9 >> 14) & 1 )
      {
        v8 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                          (UFG::SimObjectGame *)simObject,
                                                          UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
      }
      else if ( (v9 & 0x8000u) == 0 )
      {
        if ( (v9 >> 13) & 1 )
        {
          v8 = UFG::SimObjectProp::GetComponent<UFG::SimObjectWeaponPropertiesComponent>((UFG::SimObjectProp *)simObject);
        }
        else if ( (v9 >> 12) & 1 )
        {
          v8 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                            (UFG::SimObjectGame *)simObject,
                                                            UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
        }
        else
        {
          v8 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObject::GetComponentOfType(
                                                            simObject,
                                                            UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
        }
      }
      else
      {
        v8 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                          (UFG::SimObjectGame *)simObject,
                                                          UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
      }
    }
    else
    {
      v8 = 0i64;
    }
    if ( v8->mFireMode != v6->fireMode )
    {
      UFG::GunshotManager::StopGun(v5, v6);
      UFG::GunshotManagerGunInfo::Init(v6, v3);
    }
  }
  ++v6->numContinuousShotsFired;
  v6->timeSinceLastShot = 0.0;
  if ( v6->state != 1 )
  {
    v14 = UFG::gGunshotRequestPool.mFreeListHead;
    if ( UFG::gGunshotRequestPool.mFreeListHead )
    {
      UFG::gGunshotRequestPool.mFreeListHead = *(char **)UFG::gGunshotRequestPool.mFreeListHead;
      v15 = UFG::gGunshotRequestPool.mNumSlotsAllocated + 1;
      UFG::gGunshotRequestPool.mNumSlotsAllocated = v15;
      if ( UFG::gGunshotRequestPool.mMostSlotsAllocated <= v15 )
        UFG::gGunshotRequestPool.mMostSlotsAllocated = v15;
    }
    else
    {
      UFG::qFixedAllocator::ReportFull(&UFG::gGunshotRequestPool);
    }
    if ( v14 )
    {
      *(_QWORD *)v14 = v14;
      *((_QWORD *)v14 + 1) = v14;
      *((_QWORD *)v14 + 2) = 0i64;
      v25 = v14 + 24;
      *v25 = v25;
      v25[1] = v25;
      *((_QWORD *)v14 + 5) = 0i64;
      *((_QWORD *)v14 + 6) = 0i64;
      v14[56] &= 0xF0u;
    }
    else
    {
      v14 = 0i64;
    }
    if ( v14 )
    {
      v16 = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)(v14 + 24);
      if ( *((_QWORD *)v14 + 5) )
      {
        v17 = v16->mPrev;
        v18 = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)*((_QWORD *)v14 + 4);
        v17->mNext = v18;
        v18->mPrev = v17;
        v16->mPrev = v16;
        *((_QWORD *)v14 + 4) = v14 + 24;
      }
      *((_QWORD *)v14 + 5) = v3;
      if ( v3 )
      {
        v19 = v3->m_SafePointerList.mNode.mPrev;
        v19->mNext = v16;
        v16->mPrev = v19;
        *((_QWORD *)v14 + 4) = (char *)v3 + 8;
        v3->m_SafePointerList.mNode.mPrev = v16;
      }
      *((_DWORD *)v14 + 4) = v4;
      v20 = UFG::GunshotRequest::CalcDistance2ToListener((UFG::GunshotRequest *)v14);
      *((float *)v14 + 5) = v20;
      v21 = v5->m_newRequests.mNode.mNext;
      if ( v21 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v5 )
      {
        v5->m_newRequests.mNode.mNext = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v14;
        *(_QWORD *)v14 = v5;
      }
      else
      {
        if ( v20 > *((float *)&v21[1].mPrev + 1) )
        {
          do
          {
            if ( v21 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v5 )
              break;
            v21 = v21->mNext;
          }
          while ( v20 > *((float *)&v21[1].mPrev + 1) );
          if ( v20 > *((float *)&v21[1].mPrev + 1) )
          {
            v22 = (char **)v21->mNext;
            v21->mNext = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v14;
            *(_QWORD *)v14 = v21;
            *((_QWORD *)v14 + 1) = v22;
            *v22 = v14;
            return;
          }
        }
        v23 = v21->mPrev;
        v23->mNext = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v14;
        *(_QWORD *)v14 = v23;
      }
      *((_QWORD *)v14 + 1) = v21;
      v21->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v14;
    }
  }
}

// File Line: 252
// RVA: 0x5AA060
void __fastcall UFG::GunshotManager::RequestShotEnd(UFG::GunshotManager *this, unsigned int soundId, UFG::SimObject *simObject)
{
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v3; // rbx
  unsigned int v4; // er10
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **v5; // r9
  UFG::GunshotManagerGunInfo *v6; // rdx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v7; // rcx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v8; // rax

  v3 = this->m_newRequests.mNode.mNext;
  v4 = soundId;
  if ( v3 != (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)this )
  {
    while ( simObject != (UFG::SimObject *)v3[2].mNext )
    {
      v3 = v3->mNext;
      if ( v3 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)this )
        goto LABEL_4;
    }
    goto LABEL_15;
  }
LABEL_4:
  v3 = this->m_activeRequests.mNode.mNext;
  v5 = &this->m_activeRequests.mNode.mNext;
  if ( v3 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&this->m_activeRequests )
  {
LABEL_7:
    v3 = 0i64;
  }
  else
  {
    while ( simObject != (UFG::SimObject *)v3[2].mNext )
    {
      v3 = v3->mNext;
      if ( v3 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&this->m_activeRequests )
        goto LABEL_7;
    }
  }
  v6 = (UFG::GunshotManagerGunInfo *)&this->m_gunInfoList.mNode.mNext[-1].mNext;
  if ( v6 == (UFG::GunshotManagerGunInfo *)v5 )
  {
LABEL_11:
    v6 = 0i64;
  }
  else
  {
    while ( simObject != v6->simObject.m_pPointer )
    {
      v6 = (UFG::GunshotManagerGunInfo *)&v6->mNext[-1].mNext;
      if ( v6 == (UFG::GunshotManagerGunInfo *)v5 )
        goto LABEL_11;
    }
  }
  if ( v3 )
  {
    if ( (_QWORD)v3[3].mNext & 1 || !UFG::GunshotManager::HandleRequestEndAsOneShot(this, (UFG::GunshotRequest *)v3, v4) )
    {
LABEL_15:
      v7 = v3->mPrev;
      v8 = v3->mNext;
      v7->mNext = v8;
      v8->mPrev = v7;
      v3->mPrev = v3;
      v3->mNext = v3;
      UFG::GunshotRequest::~GunshotRequest((UFG::GunshotRequest *)v3);
      v3->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)UFG::gGunshotRequestPool.mFreeListHead;
      --UFG::gGunshotRequestPool.mNumSlotsAllocated;
      UFG::gGunshotRequestPool.mFreeListHead = (char *)v3;
      return;
    }
  }
  else if ( v6->state == 1 )
  {
    UFG::GunshotManager::StopGun(this, v6);
  }
}

// File Line: 392
// RVA: 0x5ACA60
void __fastcall UFG::GunshotManager::StopGun(UFG::GunshotManager *this, UFG::GunshotManagerGunInfo *pGunInfo)
{
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v2; // rbx
  UFG::qList<UFG::GunshotRequest,UFG::GunshotRequest,1,0> *v3; // rbp
  UFG::GunshotManagerGunInfo *v4; // rsi
  unsigned int v5; // er8

  v2 = this->m_activeRequests.mNode.mNext;
  v3 = &this->m_activeRequests;
  v4 = pGunInfo;
  if ( v2 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&this->m_activeRequests )
  {
    pGunInfo->state = 0;
    pGunInfo->numContinuousShotsFired = 0;
  }
  else
  {
    do
    {
      if ( v4->simObject.m_pPointer == (UFG::SimObject *)v2[2].mNext
        && (_QWORD)v2[3].mNext & 8
        && UFG::OneShotHandle::IsValid((UFG::OneShotHandle *)&v2[3]) )
      {
        v5 = stop_gunshot_loop_p.mUID;
        if ( !((_QWORD)v2[3].mNext & 2) )
          v5 = stop_gunshot_loop_ai.mUID;
        UFG::OneShot::Stop((UFG::OneShot *)v2[3].mPrev, 0, v5);
      }
      v2 = v2->mNext;
    }
    while ( v2 != (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)v3 );
    v4->state = 0;
    v4->numContinuousShotsFired = 0;
  }
}

// File Line: 426
// RVA: 0x5AF370
void __fastcall UFG::GunshotManager::Update(UFG::GunshotManager *this, float delta_sec)
{
  float v2; // xmm11_4
  float v3; // xmm8_4
  unsigned int v4; // er12
  UFG::GunshotManager *v5; // r14
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> **v6; // rdi
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **v7; // rsi
  float v8; // xmm1_4
  float v9; // xmm0_4
  bool v10; // al
  float v11; // xmm0_4
  unsigned int v12; // edx
  UFG::GunshotManager *v13; // rax
  float v14; // xmm0_4
  bool v15; // cf
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v16; // rbx
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v17; // rax
  _QWORD *v18; // r8
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v19; // rax
  UFG::GunshotRequest *v20; // rbx
  signed __int64 i; // rbp
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v22; // rcx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v23; // rax
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v24; // rax
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v25; // rsi
  signed int v26; // er15
  UFG::TransformNodeComponent *v27; // rdi
  UFG::TiDo *v28; // rax
  UFG::Audio3DListener *v29; // rbx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v30; // rbx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v31; // rax
  float v32; // xmm2_4
  float v33; // xmm2_4
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *j; // rax

  v2 = delta_sec;
  v3 = UFG::Metrics::msInstance.mSimTimeDelta;
  v4 = 0;
  v5 = this;
  v6 = &this->m_gunInfoList.mNode.mNext[-1].mNext;
  if ( this->m_gunInfoList.mNode.mNext != (UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *)8 )
  {
    v7 = &this->m_activeRequests.mNode.mNext;
    do
    {
      if ( v6 == (UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> **)v7 )
        break;
      v8 = v3 + *((float *)v6 + 7);
      v9 = *((float *)v6 + 8) + 0.050000001;
      *((float *)v6 + 7) = v8;
      v10 = v8 > v9;
      if ( v8 > v9 && *((_DWORD *)v6 + 6) )
        *((_DWORD *)v6 + 6) = 0;
      if ( UFG::Metrics::msInstance.mSimPausedDebug )
        v11 = 0.0;
      else
        v11 = UFG::Metrics::msInstance.mSimTimeScaleDebug;
      if ( (float)(v11 * UFG::Metrics::msInstance.mSimTimeScaleInGame) < 1.0 )
        *((_DWORD *)v6 + 6) = 0;
      if ( *((_DWORD *)v6 + 17) == 1 && v10 )
      {
        v12 = play_gunshot_tail_ai.mUID;
        if ( *((_BYTE *)v6 + 36) )
          v12 = play_gunshot_tail_p.mUID;
        UFG::GunshotManager::RequestShotEnd(v5, v12, (UFG::SimObject *)v6[7]);
      }
      v13 = (UFG::GunshotManager *)*v7;
      if ( *v7 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v5->m_activeRequests )
      {
LABEL_20:
        v14 = *((float *)v6 + 8);
        if ( v14 == 0.0 )
          v15 = 1.0 < *((float *)v6 + 7);
        else
          v15 = (float)(v14 * 10.0) < *((float *)v6 + 7);
        if ( v15 )
        {
          v16 = v6[1];
          v17 = v6[2];
          v18 = v6 + 1;
          v16->mNext = v17;
          v17->mPrev = v16;
          *v18 = v18;
          v18[1] = v18;
          ((void (__fastcall *)(UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> **, signed __int64))(*v6)->mPrev)(
            v6,
            1i64);
          v6 = &v16[-1].mNext;
        }
      }
      else
      {
        while ( v6[7] != v13->m_gunInfoList.mNode.mNext )
        {
          v13 = (UFG::GunshotManager *)v13->m_newRequests.mNode.mNext;
          if ( v13 == (UFG::GunshotManager *)&v5->m_activeRequests )
            goto LABEL_20;
        }
      }
      if ( !v6 )
        break;
      v6 = &v6[2][-1].mNext;
    }
    while ( v6 );
  }
  v19 = v5->m_activeRequests.mNode.mNext;
  v20 = (UFG::GunshotRequest *)v5->m_newRequests.mNode.mNext;
  for ( i = (signed __int64)&v5->m_activeRequests;
        v19 != (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)i;
        v19 = v19->mNext )
  {
    ;
  }
  for ( ; v20; v20 = (UFG::GunshotRequest *)v22->mNext )
  {
    if ( v20 == (UFG::GunshotRequest *)v5 )
      break;
    UFG::GunshotManager::HandleRequestAsOneShot(v5, v20, &v20->oneShot);
    if ( UFG::OneShotHandle::IsValid(&v20->oneShot) )
      UFG::OneShot::Play(v20->oneShot.m_pOneShot, v20->soundId);
    v22 = v20->mPrev;
    v23 = v20->mNext;
    v22->mNext = v23;
    v23->mPrev = v22;
    v20->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v20->mPrev;
    v20->mNext = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v20->mPrev;
    if ( v3 > 0.0 )
    {
      v24 = v5->m_activeRequests.mNode.mNext;
      v5->m_activeRequests.mNode.mNext = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v20->mPrev;
      v20->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)i;
      v20->mNext = v24;
      v24->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v20->mPrev;
    }
    if ( !v22 )
      break;
  }
  UFG::qList<UFG::GunshotRequest,UFG::GunshotRequest,1,0>::DeleteNodes(&v5->m_newRequests);
  v25 = v5->m_activeRequests.mNode.mNext;
  v5->m_numDistantGunshots.m_targetValue = 0.0;
  v26 = 0;
  if ( v25 )
  {
    while ( 1 )
    {
      if ( v25 == (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)i )
        break;
      if ( (_QWORD)v25[3].mNext & 1 )
      {
        v27 = (UFG::TransformNodeComponent *)v25[2].mNext[5].mNext;
        v28 = UFG::TiDo::GetInstance();
        v29 = UFG::TiDo::GetListener(v28, 0);
        UFG::TransformNodeComponent::UpdateWorldTransform(v27);
        if ( (float)((float)((float)((float)(v29->m_matrix.v3.y - v27->mWorldTransform.v3.y)
                                   * (float)(v29->m_matrix.v3.y - v27->mWorldTransform.v3.y))
                           + (float)((float)(v29->m_matrix.v3.x - v27->mWorldTransform.v3.x)
                                   * (float)(v29->m_matrix.v3.x - v27->mWorldTransform.v3.x)))
                   + (float)((float)(v29->m_matrix.v3.z - v27->mWorldTransform.v3.z)
                           * (float)(v29->m_matrix.v3.z - v27->mWorldTransform.v3.z))) >= (float)(v5->m_maxDistanceAsOneShot
                                                                                                * v5->m_maxDistanceAsOneShot) )
          goto LABEL_44;
      }
      else if ( UFG::GunshotManager::UpdateRequestAsOneShot(v5, (UFG::GunshotRequest *)v25) )
      {
        goto LABEL_44;
      }
      v30 = v25->mPrev;
      v31 = v25->mNext;
      v30->mNext = v31;
      v31->mPrev = v30;
      v25->mPrev = v25;
      v25->mNext = v25;
      UFG::GunshotRequest::~GunshotRequest((UFG::GunshotRequest *)v25);
      v25->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)UFG::gGunshotRequestPool.mFreeListHead;
      --UFG::gGunshotRequestPool.mNumSlotsAllocated;
      UFG::gGunshotRequestPool.mFreeListHead = (char *)v25;
      v25 = v30;
LABEL_44:
      if ( v25 )
      {
        if ( !((_QWORD)v25[3].mNext & 2) )
          ++v26;
        v25 = v25->mNext;
        if ( v25 )
          continue;
      }
      break;
    }
  }
  v5->m_numAiGunshots.m_riseRate = 1000.0;
  v5->m_numAiGunshots.m_fallRate = 1.0;
  v5->m_numAiGunshots.m_targetValue = (float)v26;
  if ( (float)v26 < v5->m_numAiGunshots.m_currentValue )
    v32 = v5->m_numAiGunshots.m_fallRate;
  else
    v32 = v5->m_numAiGunshots.m_riseRate;
  UFG::qApproach(&v5->m_numAiGunshots.m_currentValue, (float)v26, v32, v2);
  v33 = v5->m_numAiGunshots.m_currentValue;
  if ( v33 != last_num_ai_gunshots )
  {
    UFG::TiDo::SetWwiseRtpcValue(UFG::TiDo::m_pInstance, num_ai_gunshots, v33, 0xFFFFFFFFFFFFFFFFui64);
    last_num_ai_gunshots = v5->m_numAiGunshots.m_currentValue;
  }
  for ( j = v5->m_activeRequests.mNode.mNext; j != (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)i; j = j->mNext )
  {
    if ( (_QWORD)j[3].mNext & 1 )
      ++v4;
  }
  UFG::GunshotManager::UpdateStream(v5, v4, v2);
}if ( (_QWORD)j[3].mNext & 1 )
      ++v4;
  }
  UFG::GunshotManager::UpdateStream(v5, v4, v2);
}

// File Line: 616
// RVA: 0x1559A00
signed __int64 UFG::_dynamic_initializer_for__auto_duration__()
{
  signed __int64 result; // rax

  result = UFG::TiDo::CalcWwiseUid("auto_duration");
  auto_duration = result;
  return result;
}

// File Line: 617
// RVA: 0x1559C20
signed __int64 UFG::_dynamic_initializer_for__enable_gun_distance_effects__()
{
  signed __int64 result; // rax

  result = UFG::TiDo::CalcWwiseUid("enable_gun_distance_effects");
  enable_gun_distance_effects = result;
  return result;
}

// File Line: 620
// RVA: 0x59EEE0
void __fastcall UFG::GunshotManager::HandleRequestAsOneShot(UFG::GunshotManager *this, UFG::GunshotRequest *pRequest, UFG::OneShotHandle *pOneShot)
{
  UFG::qNode<UFG::GunshotManagerGunInfo,UFG::GunshotManagerGunInfo> *v3; // rdi
  UFG::SimObject *v4; // rax
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **v5; // rcx
  signed __int64 v6; // rdi
  UFG::SimObjectWeaponPropertiesComponent *v7; // rbp
  UFG::OneShotHandle *v8; // r14
  UFG::GunshotRequest *v9; // rsi
  UFG::qMatrix44 *v10; // rbx
  UFG::SimObject *v11; // r8
  unsigned __int16 v12; // cx
  UFG::InventoryItemComponent *v13; // rax
  bool v14; // zf
  UFG::SimObjectGame *v15; // rcx
  UFG::SimObjectCharacter *v16; // rbx
  UFG::SimObject *v17; // rax
  UFG::SimObjectProp *v18; // rcx
  UFG::SceneObjectProperties *v19; // rbx
  bool v20; // r15
  unsigned __int16 v21; // dx
  UFG::SimObjectWeaponPropertiesComponent *v22; // rax
  UFG::FireModeInfo *v23; // rbx
  float v24; // xmm7_4
  float v25; // xmm6_4
  float v26; // xmm6_4
  float v27; // xmm7_4
  char v28; // cl
  unsigned int v29; // eax
  unsigned int v30; // eax

  v3 = this->m_gunInfoList.mNode.mNext;
  v4 = pRequest->simObject.m_pPointer;
  v5 = &this->m_activeRequests.mNode.mNext;
  v6 = (signed __int64)&v3[-1].mNext;
  v7 = 0i64;
  v8 = pOneShot;
  v9 = pRequest;
  if ( (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **)v6 == v5 )
  {
LABEL_4:
    v6 = 0i64;
  }
  else
  {
    while ( v4 != *(UFG::SimObject **)(v6 + 56) )
    {
      v6 = *(_QWORD *)(v6 + 16) - 8i64;
      if ( (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **)v6 == v5 )
        goto LABEL_4;
    }
  }
  *((_BYTE *)pRequest + 56) &= 0xFEu;
  if ( v4 )
  {
    v10 = (UFG::qMatrix44 *)v4->m_pTransformNodeComponent;
    if ( v10 )
    {
      UFG::TransformNodeComponent::UpdateWorldTransform(v4->m_pTransformNodeComponent);
      UFG::OneShotPool::GetOneShotHandle(v8, v10 + 2);
      if ( UFG::OneShotHandle::IsValid(v8) )
      {
        v11 = v9->simObject.m_pPointer;
        if ( v11 )
        {
          v12 = v11->m_Flags;
          if ( !((v12 >> 14) & 1) && (v12 & 0x8000u) == 0 )
          {
            if ( (v12 >> 13) & 1 )
            {
              v13 = (UFG::InventoryItemComponent *)v11->m_Components.p[11].m_pComponent;
            }
            else
            {
              v14 = ((v12 >> 12) & 1) == 0;
              v15 = (UFG::SimObjectGame *)v9->simObject.m_pPointer;
              v13 = (UFG::InventoryItemComponent *)(v14 ? UFG::SimObject::GetComponentOfType(
                                                            (UFG::SimObject *)&v15->vfptr,
                                                            UFG::InventoryItemComponent::_TypeUID) : UFG::SimObjectGame::GetComponentOfTypeHK(v15, UFG::InventoryItemComponent::_TypeUID));
            }
            if ( v13 )
            {
              v16 = LocalPlayer;
              v17 = UFG::InventoryItemComponent::GetOwnerSimObject(v13);
              v18 = (UFG::SimObjectProp *)v9->simObject.m_pPointer;
              v14 = v17 == (UFG::SimObject *)v16;
              v19 = v18->m_pSceneObj;
              v20 = v14;
              if ( v18 )
              {
                v21 = v18->m_Flags;
                if ( (v21 >> 14) & 1 )
                {
                  v22 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                                     (UFG::SimObjectGame *)&v18->vfptr,
                                                                     UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
                }
                else if ( (v21 & 0x8000u) == 0 )
                {
                  if ( (v21 >> 13) & 1 )
                  {
                    v22 = UFG::SimObjectProp::GetComponent<UFG::SimObjectWeaponPropertiesComponent>(v18);
                  }
                  else if ( (v21 >> 12) & 1 )
                  {
                    v22 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                                       (UFG::SimObjectGame *)&v18->vfptr,
                                                                       UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
                  }
                  else
                  {
                    v22 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObject::GetComponentOfType(
                                                                       (UFG::SimObject *)&v18->vfptr,
                                                                       UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
                  }
                }
                else
                {
                  v22 = (UFG::SimObjectWeaponPropertiesComponent *)UFG::SimObjectGame::GetComponentOfTypeHK(
                                                                     (UFG::SimObjectGame *)&v18->vfptr,
                                                                     UFG::SimObjectWeaponPropertiesComponent::_TypeUID);
                }
                v7 = v22;
              }
              if ( v19 )
              {
                if ( v7 )
                {
                  v23 = v7->mWeaponTypeInfo->mFireModes[v7->mFireMode];
                  if ( v23->mAudioWeaponType.mUID != UFG::qWiseSymbol::get_null()->mUID )
                  {
                    v24 = v7->mWeaponTypeInfo->mFireModes[v7->mFireMode]->mRateOfFire;
                    *(float *)(v6 + 32) = v24;
                    if ( UFG::Metrics::msInstance.mSimPausedDebug )
                      v25 = 0.0;
                    else
                      v25 = UFG::Metrics::msInstance.mSimTimeScaleDebug;
                    v26 = v25 * UFG::Metrics::msInstance.mSimTimeScaleInGame;
                    v27 = (float)(v24 / v26) * UFG::TidoGame::sm_autoTriggerRateScale;
                    *((_BYTE *)v9 + 56) ^= (*((_BYTE *)v9 + 56) ^ 8
                                                                * v7->mWeaponTypeInfo->mFireModes[v7->mFireMode]->mAudioWeaponIsLooping) & 8;
                    UFG::AudioEntity::SetWwiseSwitch(
                      (UFG::AudioEntity *)&v8->m_pOneShot->vfptr,
                      weapon_type.mUID,
                      v23->mAudioWeaponType.mUID);
                    UFG::AudioEntity::SetRtpcValue(
                      (UFG::AudioEntity *)&v8->m_pOneShot->vfptr,
                      shot_loop_duration.mUID,
                      v27);
                    if ( *((_BYTE *)v9 + 56) & 8
                      && *(_DWORD *)(v6 + 24) > (signed int)UFG::TidoGame::sm_numShotsToTriggerGunLoop
                      && v26 >= 1.0 )
                    {
                      v28 = 1;
                      *(_DWORD *)(v6 + 68) = 1;
                    }
                    else
                    {
                      v28 = 0;
                    }
                    if ( v20 )
                    {
                      if ( v9->soundId == play_gunshot_0.mUID )
                      {
                        v30 = play_gunshot_single_p.mUID;
                        if ( v28 )
                          v30 = play_gunshot_loop_p.mUID;
                        v9->soundId = v30;
                      }
                      *((_BYTE *)v9 + 56) |= 2u;
                      UFG::AudioEntity::ApplyEnvironment(
                        (UFG::AudioEntity *)&v8->m_pOneShot->vfptr,
                        meter_critical_gunshot_volume.mUID,
                        1.0,
                        1.0,
                        1.0,
                        &UFG::WwiseEnvironment::sm_SFX);
                    }
                    else if ( v9->soundId == play_gunshot_0.mUID )
                    {
                      v29 = play_gunshot_single_ai.mUID;
                      if ( v28 )
                        v29 = play_gunshot_loop_ai.mUID;
                      v9->soundId = v29;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}_ai.mUID;
                      v9->soundId = v29;
                    }
  

// File Line: 733
// RVA: 0x5B0FB0
bool __fastcall UFG::GunshotManager::UpdateRequestAsOneShot(UFG::GunshotManager *this, UFG::GunshotRequest *pRequest)
{
  UFG::GunshotRequest *v2; // rdi
  UFG::GunshotManager *v3; // rbp
  bool result; // al
  signed __int64 v5; // rax
  float v6; // xmm0_4
  UFG::TransformNodeComponent *v7; // rbx
  UFG::OneShot *v8; // rcx
  float v9; // eax
  float v10; // xmm1_4
  UFG::AudioEntity *v11; // rcx

  v2 = pRequest;
  v3 = this;
  if ( pRequest->simObject.m_pPointer || (result = UFG::OneShotHandle::IsValid(&pRequest->oneShot), result != 1) )
  {
    if ( UFG::OneShotHandle::IsValid(&v2->oneShot) )
    {
      v5 = (signed __int64)&v3->m_gunInfoList.mNode.mNext[-1].mNext;
      if ( (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **)v5 != &v3->m_activeRequests.mNode.mNext )
      {
        while ( v2->simObject.m_pPointer != *(UFG::SimObject **)(v5 + 56) )
        {
          v5 = *(_QWORD *)(v5 + 16) - 8i64;
          if ( (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> **)v5 == &v3->m_activeRequests.mNode.mNext )
            goto LABEL_12;
        }
        if ( UFG::Metrics::msInstance.mSimPausedDebug )
          v6 = 0.0;
        else
          v6 = UFG::Metrics::msInstance.mSimTimeScaleDebug;
        UFG::AudioEntity::SetRtpcValue(
          (UFG::AudioEntity *)&v2->oneShot.m_pOneShot->vfptr,
          shot_loop_duration.mUID,
          (float)(*(float *)(v5 + 32) / (float)(v6 * UFG::Metrics::msInstance.mSimTimeScaleInGame))
        * UFG::TidoGame::sm_autoTriggerRateScale);
      }
LABEL_12:
      v7 = v2->simObject.m_pPointer->m_pTransformNodeComponent;
      UFG::TransformNodeComponent::UpdateWorldTransform(v7);
      v8 = v2->oneShot.m_pOneShot;
      v9 = v7->mWorldTransform.v3.x;
      v10 = v7->mWorldTransform.v3.z;
      v8->m_WorldMatrix.v3.y = v7->mWorldTransform.v3.y;
      v8->m_WorldMatrix.v3.z = v10;
      v8->m_WorldMatrix.v3.x = v9;
      v8->m_WorldMatrix.v3.w = 1.0;
      UFG::AudioEntity::ForcePositionUpdate((UFG::AudioEntity *)&v8->vfptr);
      v11 = (UFG::AudioEntity *)&v2->oneShot.m_pOneShot->vfptr;
      if ( *((_BYTE *)v2 + 56) & 2 )
        UFG::AudioEntity::SetRtpcValue(v11, num_distant_gunshots, 0.0);
      else
        UFG::AudioEntity::SetRtpcValue(v11, num_distant_gunshots, v3->m_numDistantGunshots.m_currentValue);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

// File Line: 776
// RVA: 0x5B11E0
void __fastcall UFG::GunshotManager::UpdateStream(UFG::GunshotManager *this, unsigned int numStreamingRequests, float delta_sec)
{
  float *v3; // rbx
  float v4; // xmm3_4
  float v5; // xmm1_4
  float v6; // xmm2_4
  float v7; // xmm6_4
  UFG::TiDo *v8; // rax

  v3 = &this->m_numDistantGunshots.m_currentValue;
  this->m_numDistantGunshots.m_riseRate = 10000.0;
  this->m_numDistantGunshots.m_fallRate = 0.2;
  v4 = delta_sec;
  this->m_numDistantGunshots.m_targetValue = (float)(signed int)numStreamingRequests;
  v5 = this->m_numDistantGunshots.m_targetValue;
  if ( v5 < this->m_numDistantGunshots.m_currentValue )
    v6 = this->m_numDistantGunshots.m_fallRate;
  else
    v6 = this->m_numDistantGunshots.m_riseRate;
  UFG::qApproach(&this->m_numDistantGunshots.m_currentValue, v5, v6, v4);
  v7 = *v3;
  if ( *v3 != last_num_distant_gunshots )
  {
    v8 = UFG::TiDo::GetInstance();
    UFG::TiDo::SetWwiseRtpcValue(v8, num_distant_gunshots, v7, 0xFFFFFFFFFFFFFFFFui64);
    last_num_distant_gunshots = *v3;
  }
}

// File Line: 805
// RVA: 0x59F1F0
char __fastcall UFG::GunshotManager::HandleRequestEndAsOneShot(UFG::GunshotManager *this, UFG::GunshotRequest *pRequest, unsigned int soundId)
{
  unsigned int v3; // ebp
  UFG::GunshotRequest *v4; // rbx
  UFG::GunshotManager *v5; // rsi
  UFG::GunshotManagerGunInfo *v6; // rdx
  UFG::OneShotHandle v8; // [rsp+48h] [rbp+10h]

  v3 = soundId;
  v4 = pRequest;
  v5 = this;
  if ( *((_BYTE *)pRequest + 56) & 4 )
    return 1;
  if ( UFG::OneShotHandle::IsValid(&pRequest->oneShot) && *((_BYTE *)v4 + 56) & 8 )
  {
    v6 = (UFG::GunshotManagerGunInfo *)&v5->m_gunInfoList.mNode.mNext[-1].mNext;
    if ( v6 == (UFG::GunshotManagerGunInfo *)&v5->m_activeRequests.mNode.mNext )
    {
LABEL_7:
      v6 = 0i64;
    }
    else
    {
      while ( v4->simObject.m_pPointer != v6->simObject.m_pPointer )
      {
        v6 = (UFG::GunshotManagerGunInfo *)&v6->mNext[-1].mNext;
        if ( v6 == (UFG::GunshotManagerGunInfo *)&v5->m_activeRequests.mNode.mNext )
          goto LABEL_7;
      }
    }
    UFG::GunshotManager::StopGun(v5, v6);
  }
  UFG::OneShotHandle::Release(&v4->oneShot);
  if ( v3 )
  {
    v4->soundId = v3;
    v8.m_pOneShot = 0i64;
    UFG::GunshotManager::HandleRequestAsOneShot(v5, v4, &v4->oneShot);
    if ( UFG::OneShotHandle::IsValid(&v4->oneShot) )
    {
      UFG::OneShot::Play(v4->oneShot.m_pOneShot, v4->soundId);
      *((_BYTE *)v4 + 56) |= 4u;
      UFG::OneShotHandle::Release(&v8);
      return 1;
    }
    UFG::OneShotHandle::Release(&v8);
  }
  return 0;
}

// File Line: 849
// RVA: 0x594690
void __fastcall UFG::GunshotRequest::~GunshotRequest(UFG::GunshotRequest *this)
{
  UFG::GunshotRequest *v1; // rbx
  UFG::qSafePointer<UFG::SimObject,UFG::SimObject> *v2; // rdx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v3; // rcx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v4; // rax
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v5; // rcx
  UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *v6; // rax
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v7; // rcx
  UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *v8; // rax

  v1 = this;
  UFG::OneShotHandle::Release(&this->oneShot);
  v2 = &v1->simObject;
  if ( v1->simObject.m_pPointer )
  {
    v3 = v2->mPrev;
    v4 = v1->simObject.mNext;
    v3->mNext = v4;
    v4->mPrev = v3;
    v2->mPrev = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v2->mPrev;
    v1->simObject.mNext = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v1->simObject.mPrev;
  }
  v1->simObject.m_pPointer = 0i64;
  v5 = v2->mPrev;
  v6 = v1->simObject.mNext;
  v5->mNext = v6;
  v6->mPrev = v5;
  v2->mPrev = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v2->mPrev;
  v1->simObject.mNext = (UFG::qNode<UFG::qSafePointerBase<UFG::SimObject>,UFG::qSafePointerNodeList> *)&v1->simObject.mPrev;
  v7 = v1->mPrev;
  v8 = v1->mNext;
  v7->mNext = v8;
  v8->mPrev = v7;
  v1->mPrev = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v1->mPrev;
  v1->mNext = (UFG::qNode<UFG::GunshotRequest,UFG::GunshotRequest> *)&v1->mPrev;
}

// File Line: 853
// RVA: 0x5974F0
float __fastcall UFG::GunshotRequest::CalcDistance2ToListener(UFG::GunshotRequest *this)
{
  UFG::TransformNodeComponent *v1; // rdi
  UFG::TiDo *v2; // rax
  UFG::Audio3DListener *v3; // rbx

  v1 = this->simObject.m_pPointer->m_pTransformNodeComponent;
  v2 = UFG::TiDo::GetInstance();
  v3 = UFG::TiDo::GetListener(v2, 0);
  UFG::TransformNodeComponent::UpdateWorldTransform(v1);
  return (float)((float)((float)(v3->m_matrix.v3.y - v1->mWorldTransform.v3.y)
                       * (float)(v3->m_matrix.v3.y - v1->mWorldTransform.v3.y))
               + (float)((float)(v3->m_matrix.v3.x - v1->mWorldTransform.v3.x)
                       * (float)(v3->m_matrix.v3.x - v1->mWorldTransform.v3.x)))
       + (float)((float)(v3->m_matrix.v3.z - v1->mWorldTransform.v3.z)
               * (float)(v3->m_matrix.v3.z - v1->mWorldTransform.v3.z));
}

