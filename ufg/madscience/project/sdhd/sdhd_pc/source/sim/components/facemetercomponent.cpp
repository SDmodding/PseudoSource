// File Line: 51
// RVA: 0x1544680
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_Events__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("Events", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_Events, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_Events__);
}

// File Line: 52
// RVA: 0x15446C0
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_FaceAdjustment__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("FaceAdjustment", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_FaceAdjustment, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_FaceAdjustment__);
}

// File Line: 53
// RVA: 0x1544600
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_CopPoints__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("CopPoints", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_CopPoints, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_CopPoints__);
}

// File Line: 54
// RVA: 0x1544840
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_TriadPoints__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("TriadPoints", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_TriadPoints, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_TriadPoints__);
}

// File Line: 55
// RVA: 0x1544880
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_XPFlasherCaption__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("XPFlasherCaption", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_XPFlasherCaption, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_XPFlasherCaption__);
}

// File Line: 56
// RVA: 0x1544780
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_MultiplierReduction__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("MultiplierReduction", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_MultiplierReduction, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_MultiplierReduction__);
}

// File Line: 57
// RVA: 0x15447C0
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_MultiplierResetTimer__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("MultiplierResetTimer", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_MultiplierResetTimer, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_MultiplierResetTimer__);
}

// File Line: 58
// RVA: 0x1544800
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_MultiplierSlowMode__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("MultiplierSlowMode", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_MultiplierSlowMode, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_MultiplierSlowMode__);
}

// File Line: 59
// RVA: 0x1544740
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_MeterCooldownStartsAfter__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("MeterCooldownStartsAfter", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_MeterCooldownStartsAfter, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_MeterCooldownStartsAfter__);
}

// File Line: 60
// RVA: 0x1544700
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_MeterCooldownRatePerSecond__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("MeterCooldownDrainRatePerSecond", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_MeterCooldownRatePerSecond, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_MeterCooldownRatePerSecond__);
}

// File Line: 61
// RVA: 0x1544580
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_ActivatedMeterCooldownRatePerSecond__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("ActivatedMeterCooldownDrainRatePerSecond", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_ActivatedMeterCooldownRatePerSecond, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_ActivatedMeterCooldownRatePerSecond__);
}

// File Line: 62
// RVA: 0x1544640
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_Disabled__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("Disabled", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_Disabled, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_Disabled__);
}

// File Line: 63
// RVA: 0x15445C0
__int64 UFG::_dynamic_initializer_for__FaceEventSymbol_AdjustmentType__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("AdjustmentType", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&FaceEventSymbol_AdjustmentType, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__FaceEventSymbol_AdjustmentType__);
}

// File Line: 67
// RVA: 0x549BF0
void __fastcall UFG::ScoreAffector::Reset(UFG::ScoreAffector *this)
{
  this->mIsActive = 0;
  this->mCurrentMultiplier = 1.0;
}

// File Line: 73
// RVA: 0x556DC0
float __fastcall UFG::ScoreAffector::Trigger(UFG::ScoreAffector *this)
{
  float mCurrentMultiplier; // xmm3_4
  float v2; // xmm0_4
  float v3; // xmm2_4
  float mMultiplierResetTimer; // xmm0_4
  float v5; // xmm1_4
  float result; // xmm0_4

  mCurrentMultiplier = this->mCurrentMultiplier;
  this->mIsActive = 1;
  this->mTimestamp = UFG::Metrics::msInstance.mSimTimeMSec;
  v2 = mCurrentMultiplier - this->mMultiplierReduction;
  if ( v2 <= 0.0 )
  {
    v2 = 0.0;
    goto LABEL_5;
  }
  v3 = FLOAT_2_0;
  if ( v2 < 2.0 )
LABEL_5:
    v3 = v2;
  mMultiplierResetTimer = this->mMultiplierResetTimer;
  this->mCurrentMultiplier = v3;
  if ( mMultiplierResetTimer <= 0.0 )
  {
    this->mMultiplierReplenishRate = 1.0;
    return mCurrentMultiplier;
  }
  else
  {
    v5 = (float)(1.0 - v3) / mMultiplierResetTimer;
    result = mCurrentMultiplier;
    this->mMultiplierReplenishRate = v5;
  }
  return result;
}

// File Line: 93
// RVA: 0x55C510
float __fastcall UFG::ScoreAffector::Update(UFG::ScoreAffector *this, float deltaTime)
{
  float v2; // xmm0_4
  float result; // xmm0_4
  float mMultiplierResetTimer; // xmm3_4
  float v5; // xmm1_4
  float v6; // xmm2_4

  v2 = (float)(LODWORD(UFG::Metrics::msInstance.mSimTimeMSec) - LODWORD(this->mTimestamp));
  if ( (__int64)(UFG::Metrics::msInstance.mSimTimeMSec - this->mTimestamp) < 0 )
    v2 = v2 + 1.8446744e19;
  result = v2 * 0.001;
  if ( !this->mIsActive )
  {
    result = *(float *)&FLOAT_1_0;
    this->mCurrentMultiplier = 1.0;
    return result;
  }
  mMultiplierResetTimer = this->mMultiplierResetTimer;
  if ( result >= mMultiplierResetTimer )
  {
    this->mCurrentMultiplier = 1.0;
    goto LABEL_12;
  }
  v5 = (float)(deltaTime * this->mMultiplierReplenishRate) + this->mCurrentMultiplier;
  if ( v5 <= 0.0 )
  {
    v5 = 0.0;
  }
  else
  {
    v6 = FLOAT_2_0;
    if ( v5 >= 2.0 )
      goto LABEL_11;
  }
  v6 = v5;
LABEL_11:
  this->mCurrentMultiplier = v6;
LABEL_12:
  if ( result >= mMultiplierResetTimer )
    this->mIsActive = 0;
  return result;
}

// File Line: 138
// RVA: 0x1543E40
__int64 dynamic_initializer_for__UFG::FaceMeterComponent::s_FaceMeterComponentList__()
{
  return atexit((int (__fastcall *)())dynamic_atexit_destructor_for__UFG::FaceMeterComponent::s_FaceMeterComponentList__);
}

// File Line: 139
// RVA: 0x5326B0
__int64 __fastcall UFG::FaceMeterComponent::GetTypeSize(UFG::FaceMeterComponent *this)
{
  return 8672i64;
}

// File Line: 147
// RVA: 0x5171C0
void __fastcall UFG::FaceMeterComponent::FaceMeterComponent(UFG::FaceMeterComponent *this, unsigned int name_uid)
{
  __int64 v3; // rdi
  UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *mPrev; // rax
  float *p_mCurrentMultiplier; // rax

  UFG::SimComponent::SimComponent(this, name_uid);
  this->mPrev = &this->UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent>;
  this->mNext = &this->UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent>;
  this->vfptr = (UFG::qSafePointerNode<UFG::SimComponent>Vtbl *)&UFG::FaceMeterComponent::`vftable;
  v3 = 107i64;
  `eh vector constructor iterator(
    this->mAffectors,
    0x50ui64,
    107,
    (void (__fastcall *)(void *))UFG::ScoreAffector::ScoreAffector);
  this->mLastActionPerformedTimestamp = 0i64;
  *(_WORD *)&this->mFaceMeterEnabled = 1;
  UFG::PropertySetHandle::PropertySetHandle(&this->mProperties);
  mPrev = UFG::FaceMeterComponent::s_FaceMeterComponentList.mNode.mPrev;
  UFG::FaceMeterComponent::s_FaceMeterComponentList.mNode.mPrev->mNext = &this->UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent>;
  this->mPrev = mPrev;
  this->mNext = (UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *)&UFG::FaceMeterComponent::s_FaceMeterComponentList;
  UFG::FaceMeterComponent::s_FaceMeterComponentList.mNode.mPrev = &this->UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent>;
  UFG::SimComponent::AddType(this, UFG::FaceMeterComponent::_FaceMeterComponentTypeUID, "FaceMeterComponent");
  p_mCurrentMultiplier = &this->mAffectors[0].mCurrentMultiplier;
  do
  {
    *((_BYTE *)p_mCurrentMultiplier + 28) = 0;
    *p_mCurrentMultiplier = 1.0;
    p_mCurrentMultiplier += 20;
    --v3;
  }
  while ( v3 );
}

// File Line: 161
// RVA: 0x51B670
void __fastcall UFG::FaceMeterComponent::~FaceMeterComponent(UFG::FaceMeterComponent *this)
{
  UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *v2; // rbx
  UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *mPrev; // rcx
  UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *mNext; // rax
  UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *v5; // rcx
  UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent> *v6; // rax

  this->vfptr = (UFG::qSafePointerNode<UFG::SimComponent>Vtbl *)&UFG::FaceMeterComponent::`vftable;
  if ( this == UFG::FaceMeterComponent::s_FaceMeterComponentpCurrentIterator )
    UFG::FaceMeterComponent::s_FaceMeterComponentpCurrentIterator = (UFG::FaceMeterComponent *)&this->mPrev[-4];
  v2 = &this->UFG::qNode<UFG::FaceMeterComponent,UFG::FaceMeterComponent>;
  mPrev = this->mPrev;
  mNext = v2->mNext;
  mPrev->mNext = mNext;
  mNext->mPrev = mPrev;
  v2->mPrev = v2;
  v2->mNext = v2;
  UFG::PropertySetHandle::~PropertySetHandle(&this->mProperties);
  `eh vector destructor iterator(
    this->mAffectors,
    0x50ui64,
    107,
    (void (__fastcall *)(void *))UFG::ScoreAffector::~ScoreAffector);
  v5 = v2->mPrev;
  v6 = v2->mNext;
  v5->mNext = v6;
  v6->mPrev = v5;
  v2->mPrev = v2;
  v2->mNext = v2;
  UFG::SimComponent::~SimComponent(this);
}

// File Line: 167
// RVA: 0x1549A00
__int64 UFG::_dynamic_initializer_for__gsymDefaultFacesystemEvents__()
{
  unsigned int v0; // eax

  v0 = UFG::qStringHash32("default-facesystem-events", 0xFFFFFFFF);
  UFG::qSymbol::qSymbol((UFG::qWiseSymbol *)&UFG::gsymDefaultFacesystemEvents, v0);
  return atexit((int (__fastcall *)())UFG::_dynamic_atexit_destructor_for__gsymDefaultFacesystemEvents__);
}

// File Line: 170
// RVA: 0x53DD50
void __fastcall UFG::FaceMeterComponent::OnAttach(UFG::FaceMeterComponent *this, UFG::SimObject *pObject)
{
  UFG::qPropertySet *PropertySet; // rax
  fastdelegate::FastDelegate1<UFG::Event *,void> v4; // [rsp+30h] [rbp-18h] BYREF

  PropertySet = UFG::PropertySetManager::GetPropertySet(&UFG::gsymDefaultFacesystemEvents);
  UFG::PropertySetHandle::SetPropSet(&this->mProperties, PropertySet);
  v4.m_Closure.m_pthis = (fastdelegate::detail::GenericClass *)Assembly::GetRCX(this);
  v4.m_Closure.m_pFunction = (void (__fastcall *)(fastdelegate::detail::GenericClass *))UFG::FaceMeterComponent::HandleGameStatEvent;
  UFG::EventDispatcher::Register(
    &UFG::EventDispatcher::mInstance,
    &v4,
    UFG::gGameStatEventChannel.mUID,
    UFG::gGameStatEventChannel.mName,
    0);
}

// File Line: 177
// RVA: 0x540420
void __fastcall UFG::FaceMeterComponent::OnDetach(UFG::FaceMeterComponent *this)
{
  fastdelegate::FastDelegate1<UFG::Event *,void> v2; // [rsp+20h] [rbp-18h] BYREF

  UFG::PropertySetHandle::Null(&this->mProperties);
  v2.m_Closure.m_pFunction = (void (__fastcall *)(fastdelegate::detail::GenericClass *))UFG::FaceMeterComponent::HandleGameStatEvent;
  v2.m_Closure.m_pthis = (fastdelegate::detail::GenericClass *)Assembly::GetRCX(this);
  UFG::EventDispatcher::UnRegister(&UFG::EventDispatcher::mInstance, &v2, UFG::gGameStatEventChannel.mUID);
}

// File Line: 189
// RVA: 0x563BA0
void __fastcall UFG::FaceMeterComponent::_HandleInVehicleReplenish(UFG::FaceMeterComponent *this, float deltaTime)
{
  UFG::SimObject *m_pSimObject; // rcx
  __int16 m_Flags; // dx
  UFG::SimComponent *ComponentOfType; // rax
  unsigned int v5; // r8d
  unsigned int v6; // r9d
  __int64 v7; // rdx
  unsigned int vfptr; // r8d
  unsigned int size; // r9d
  unsigned int v10; // r8d
  unsigned int v11; // r9d
  UFG::qNode<UFG::RebindingComponentHandleBase,UFG::RebindingComponentHandleBase> *mPrev; // rcx
  UFG::qNode<UFG::RebindingComponentHandleBase,UFG::RebindingComponentHandleBase> *mNext; // rax
  UFG::qNode<UFG::RebindingComponentHandleBase,UFG::RebindingComponentHandleBase> *v14; // rdx
  UFG::qNode<UFG::RebindingComponentHandleBase,UFG::RebindingComponentHandleBase> *v15; // rbx
  UFG::PhysicsMoverInterface *v16; // rcx

  m_pSimObject = this->m_pSimObject;
  if ( !m_pSimObject )
    return;
  m_Flags = m_pSimObject->m_Flags;
  if ( (m_Flags & 0x4000) == 0 )
  {
    if ( m_Flags >= 0 )
    {
      if ( (m_Flags & 0x2000) != 0 )
      {
        vfptr = (unsigned int)m_pSimObject[1].vfptr;
        size = m_pSimObject->m_Components.size;
        if ( vfptr < size )
        {
          v7 = (__int64)&m_pSimObject->m_Components.p[vfptr];
          while ( (*(_DWORD *)(v7 + 8) & 0xFE000000) != (UFG::CharacterOccupantComponent::_TypeUID & 0xFE000000)
               || (UFG::CharacterOccupantComponent::_TypeUID & ~*(_DWORD *)(v7 + 8) & 0x1FFFFFF) != 0 )
          {
            ++vfptr;
            v7 += 16i64;
            if ( vfptr >= size )
            {
              ComponentOfType = 0i64;
              goto LABEL_27;
            }
          }
          goto LABEL_11;
        }
      }
      else
      {
        if ( (m_Flags & 0x1000) == 0 )
        {
          ComponentOfType = UFG::SimObject::GetComponentOfType(m_pSimObject, UFG::CharacterOccupantComponent::_TypeUID);
          goto LABEL_27;
        }
        v10 = (unsigned int)m_pSimObject[1].vfptr;
        v11 = m_pSimObject->m_Components.size;
        if ( v10 < v11 )
        {
          v7 = (__int64)&m_pSimObject->m_Components.p[v10];
          while ( (*(_DWORD *)(v7 + 8) & 0xFE000000) != (UFG::CharacterOccupantComponent::_TypeUID & 0xFE000000)
               || (UFG::CharacterOccupantComponent::_TypeUID & ~*(_DWORD *)(v7 + 8) & 0x1FFFFFF) != 0 )
          {
            ++v10;
            v7 += 16i64;
            if ( v10 >= v11 )
            {
              ComponentOfType = 0i64;
              goto LABEL_27;
            }
          }
          goto LABEL_11;
        }
      }
    }
    else
    {
      v5 = (unsigned int)m_pSimObject[1].vfptr;
      v6 = m_pSimObject->m_Components.size;
      if ( v5 < v6 )
      {
        v7 = (__int64)&m_pSimObject->m_Components.p[v5];
        while ( (*(_DWORD *)(v7 + 8) & 0xFE000000) != (UFG::CharacterOccupantComponent::_TypeUID & 0xFE000000)
             || (UFG::CharacterOccupantComponent::_TypeUID & ~*(_DWORD *)(v7 + 8) & 0x1FFFFFF) != 0 )
        {
          ++v5;
          v7 += 16i64;
          if ( v5 >= v6 )
            goto LABEL_10;
        }
LABEL_11:
        ComponentOfType = *(UFG::SimComponent **)v7;
        goto LABEL_27;
      }
    }
LABEL_10:
    ComponentOfType = 0i64;
    goto LABEL_27;
  }
  ComponentOfType = m_pSimObject->m_Components.p[44].m_pComponent;
LABEL_27:
  if ( ComponentOfType )
  {
    mPrev = ComponentOfType[1].m_BoundComponentHandles.mNode.mPrev;
    if ( mPrev )
    {
      mNext = mPrev[2].mNext;
      if ( mNext )
      {
        v14 = mNext[6].mNext;
        v15 = v14[3].mPrev;
        if ( v15 )
        {
          if ( ((UFG::SimObjectVehiclePropertiesComponent::_TypeUID ^ LODWORD(v15[1].mNext)) & 0xFE000000) == 0
            && (UFG::SimObjectVehiclePropertiesComponent::_TypeUID & ~LODWORD(v15[1].mNext) & 0x1FFFFFF) == 0 )
          {
            v16 = (UFG::PhysicsMoverInterface *)v14[34].mPrev;
            if ( v16 )
            {
              if ( UFG::PhysicsMoverInterface::GetEngineDamage(v16) < 0.5 )
                UFG::GameStatAction::Player::ClampAndApplyDeltaCombatMeter(
                  (float)(deltaTime * 0.0) * *(float *)&v15[12].mNext,
                  0);
            }
          }
        }
      }
    }
  }
}

// File Line: 215
// RVA: 0x54C900
void __fastcall UFG::FaceMeterComponent::SetFaceMeterActivated(UFG::FaceMeterComponent *this, bool bFaceMeterActivated)
{
  UFG::qWiseSymbol result; // [rsp+58h] [rbp+10h] BYREF

  this->mFaceMeterActivated = bFaceMeterActivated;
  UFG::qWiseSymbol::create_from_string(&result, "play_face_meter_enter");
  if ( UFG::HudAudio::m_instance )
    UFG::AudioEntity::CreateAndPlayEvent(UFG::HudAudio::m_instance, result.mUID, 0i64, 0, 0i64);
  _((AMD_HD3D *)result.mUID);
}

// File Line: 222
// RVA: 0x55B1A0
void __fastcall UFG::FaceMeterComponent::Update(UFG::FaceMeterComponent *this, float deltaTime)
{
  UFG::ScoreAffector *mAffectors; // rbx
  __int64 v4; // rsi
  float *v5; // rax
  UFG::GameStatTracker *v6; // rax
  signed __int64 mLastActionPerformedTimestamp; // rax
  float v8; // xmm0_4
  float v9; // xmm6_4
  float v10; // xmm7_4
  UFG::GameStatTracker *v11; // rax
  float Stat; // xmm6_4
  float v13; // xmm7_4
  UFG::qWiseSymbol result; // [rsp+80h] [rbp+8h] BYREF

  if ( this->mFaceMeterEnabled && NISManager::GetInstance()->mState == STATE_INVALID )
  {
    UFG::FaceMeterComponent::_HandleInVehicleReplenish(this, deltaTime);
    mAffectors = this->mAffectors;
    v4 = 107i64;
    do
    {
      UFG::ScoreAffector::Update(mAffectors++, deltaTime);
      --v4;
    }
    while ( v4 );
    if ( this->mFaceMeterActivated )
    {
      UFG::PropertySetHandle::Bind(&this->mProperties);
      v5 = UFG::qPropertySet::Get<float>(
             this->mProperties.mpPropSet,
             (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_ActivatedMeterCooldownRatePerSecond,
             DEPTH_RECURSE);
      UFG::GameStatAction::Player::ClampAndApplyDeltaCombatMeter(
        COERCE_FLOAT(COERCE_UNSIGNED_INT(*v5 * deltaTime) ^ _xmm[0]),
        0);
      v6 = UFG::GameStatTracker::Instance();
      if ( UFG::GameStatTracker::GetStat(v6, Face) <= 0.0 )
      {
        this->mFaceMeterActivated = 0;
        UFG::qWiseSymbol::create_from_string(&result, "play_face_meter_exit");
        if ( UFG::HudAudio::m_instance )
          UFG::AudioEntity::CreateAndPlayEvent(UFG::HudAudio::m_instance, result.mUID, 0i64, 0, 0i64);
        _((AMD_HD3D *)result.mUID);
      }
    }
    else
    {
      mLastActionPerformedTimestamp = this->mLastActionPerformedTimestamp;
      if ( mLastActionPerformedTimestamp )
      {
        v8 = (float)(int)mLastActionPerformedTimestamp;
        if ( mLastActionPerformedTimestamp < 0 )
          v8 = v8 + 1.8446744e19;
        v9 = UFG::Metrics::msInstance.mSimTime_Temp - v8;
        UFG::PropertySetHandle::Bind(&this->mProperties);
        if ( v9 > *UFG::qPropertySet::Get<float>(
                     this->mProperties.mpPropSet,
                     (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_MeterCooldownStartsAfter,
                     DEPTH_RECURSE) )
        {
          UFG::PropertySetHandle::Bind(&this->mProperties);
          v10 = *UFG::qPropertySet::Get<float>(
                   this->mProperties.mpPropSet,
                   (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_MeterCooldownRatePerSecond,
                   DEPTH_RECURSE);
          v11 = UFG::GameStatTracker::Instance();
          Stat = UFG::GameStatTracker::GetStat(v11, Face);
          v13 = v10 * deltaTime;
          UFG::GameStatAction::Player::ClampAndApplyDeltaCombatMeter(COERCE_FLOAT(LODWORD(v13) ^ _xmm[0]), 0);
          if ( Stat <= v13 )
            this->mLastActionPerformedTimestamp = 0i64;
        }
      }
    }
  }
}

// File Line: 333
// RVA: 0x549660
void __fastcall UFG::FaceMeterComponent::Reset(UFG::FaceMeterComponent *this)
{
  float *p_mCurrentMultiplier; // rax
  __int64 v3; // rdx
  UFG::qWiseSymbol result; // [rsp+50h] [rbp+8h] BYREF

  p_mCurrentMultiplier = &this->mAffectors[0].mCurrentMultiplier;
  v3 = 107i64;
  do
  {
    *((_BYTE *)p_mCurrentMultiplier + 28) = 0;
    *p_mCurrentMultiplier = 1.0;
    p_mCurrentMultiplier += 20;
    --v3;
  }
  while ( v3 );
  this->mLastActionPerformedTimestamp = 0i64;
  this->mFaceMeterActivated = 0;
  UFG::qWiseSymbol::create_from_string(&result, "play_face_meter_exit");
  if ( UFG::HudAudio::m_instance )
    UFG::AudioEntity::CreateAndPlayEvent(UFG::HudAudio::m_instance, result.mUID, 0i64, 0, 0i64);
  this->mFaceMeterEnabled = 1;
  _((AMD_HD3D *)result.mUID);
}

// File Line: 348
// RVA: 0x521E80
__int64 __fastcall UFG::FaceMeterComponent::ApplyEvent(
        UFG::FaceMeterComponent *this,
        UFG::FaceEventParameters *parameters)
{
  int mType; // edx
  unsigned __int8 v4; // bl
  int v6; // edx
  UFG::GameStatTracker *v7; // rax
  int Faction; // eax
  UFG::GameStatTracker *v10; // rax
  int v11; // eax
  UFG::qPropertySet *mpPropertySet; // r8

  mType = parameters->mType;
  v4 = 0;
  if ( mType <= 107 )
  {
    mpPropertySet = parameters->mpPropertySet;
    if ( parameters->mIsApply )
      return (unsigned __int8)UFG::FaceMeterComponent::_ApplyEvent(this, (UFG::GameStatEventType)mType, mpPropertySet);
    else
      return UFG::FaceMeterComponent::_UnapplyEvent(this, (UFG::GameStatEventType)mType, mpPropertySet);
  }
  v6 = mType - 108;
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      v7 = UFG::FactionInterface::Get();
      Faction = UFG::FactionInterface::GetFaction(
                  &v7->mFactionInterface,
                  (UFG::SimObjectCVBase *)parameters->mpSimObject);
      if ( Faction == 3 )
        return (unsigned __int8)UFG::FaceMeterComponent::_ApplyEvent(this, GameStatEvent_FSR_MurderCop);
      if ( (unsigned int)(Faction - 16) <= 1 )
        return (unsigned __int8)UFG::FaceMeterComponent::_ApplyEvent(this, GameStatEvent_FSR_MurderCivilian);
    }
  }
  else
  {
    v10 = UFG::FactionInterface::Get();
    v11 = UFG::FactionInterface::GetFaction(&v10->mFactionInterface, (UFG::SimObjectCVBase *)parameters->mpSimObject);
    if ( v11 == 3 )
      return (unsigned __int8)UFG::FaceMeterComponent::_ApplyEvent(this, GameStatEvent_FSR_DamageCop);
    if ( (unsigned int)(v11 - 16) <= 1 )
      return (unsigned __int8)UFG::FaceMeterComponent::_ApplyEvent(this, GameStatEvent_FSR_DamageCivilian);
  }
  return v4;
}

// File Line: 438
// RVA: 0x534200
void __fastcall UFG::FaceMeterComponent::HandleGameStatEvent(UFG::FaceMeterComponent *this, UFG::Event *e)
{
  signed int vfptr; // r14d
  UFG::SimObjectCharacter *mPrev; // rbp
  bool v5; // si
  UFG::SimObjectCharacter *Target; // rdi
  __int16 m_Flags; // cx
  UFG::SimComponent *m_pComponent; // rbx
  unsigned int mComponentTableEntryCount; // edx
  unsigned int size; // r8d
  __int64 v11; // rbx
  unsigned int v12; // edx
  unsigned int v13; // r8d
  unsigned __int64 v14; // rax
  __int64 v15; // rcx
  bool pIsAmbient; // [rsp+58h] [rbp+10h] BYREF
  bool pIsCop; // [rsp+60h] [rbp+18h] BYREF

  vfptr = (signed int)e[1].vfptr;
  mPrev = (UFG::SimObjectCharacter *)e[1].mPrev;
  v5 = 1;
  Target = (UFG::SimObjectCharacter *)UFG::getTarget(mPrev, eTARGET_TYPE_GRAPPLE);
  UFG::GameStatAction::Player::HandleGameStatEvent(mPrev, Target, vfptr);
  if ( Target == LocalPlayer || !Target )
  {
    Target = mPrev;
    if ( !mPrev )
      goto LABEL_29;
  }
  m_Flags = Target->m_Flags;
  if ( (m_Flags & 0x4000) == 0 )
  {
    if ( m_Flags < 0 )
    {
      m_pComponent = Target->m_Components.p[6].m_pComponent;
      goto LABEL_24;
    }
    if ( (m_Flags & 0x2000) != 0 )
    {
      mComponentTableEntryCount = Target->mComponentTableEntryCount;
      size = Target->m_Components.size;
      if ( mComponentTableEntryCount < size )
      {
        v11 = (__int64)&Target->m_Components.p[mComponentTableEntryCount];
        while ( (*(_DWORD *)(v11 + 8) & 0xFE000000) != (UFG::HealthComponent::_TypeUID & 0xFE000000)
             || (UFG::HealthComponent::_TypeUID & ~*(_DWORD *)(v11 + 8) & 0x1FFFFFF) != 0 )
        {
          ++mComponentTableEntryCount;
          v11 += 16i64;
          if ( mComponentTableEntryCount >= size )
            goto LABEL_14;
        }
LABEL_15:
        m_pComponent = *(UFG::SimComponent **)v11;
        goto LABEL_24;
      }
    }
    else
    {
      if ( (m_Flags & 0x1000) == 0 )
      {
        m_pComponent = UFG::SimObject::GetComponentOfType(Target, UFG::HealthComponent::_TypeUID);
        goto LABEL_24;
      }
      v12 = Target->mComponentTableEntryCount;
      v13 = Target->m_Components.size;
      if ( v12 < v13 )
      {
        v11 = (__int64)&Target->m_Components.p[v12];
        while ( (*(_DWORD *)(v11 + 8) & 0xFE000000) != (UFG::HealthComponent::_TypeUID & 0xFE000000)
             || (UFG::HealthComponent::_TypeUID & ~*(_DWORD *)(v11 + 8) & 0x1FFFFFF) != 0 )
        {
          ++v12;
          v11 += 16i64;
          if ( v12 >= v13 )
          {
            m_pComponent = 0i64;
            goto LABEL_24;
          }
        }
        goto LABEL_15;
      }
    }
LABEL_14:
    m_pComponent = 0i64;
    goto LABEL_24;
  }
  m_pComponent = Target->m_Components.p[6].m_pComponent;
LABEL_24:
  pIsCop = 0;
  pIsAmbient = 0;
  UFG::GameStatAction::MissionScoring::DeduceFaction(Target, &pIsCop, &pIsAmbient);
  v5 = !pIsAmbient;
  if ( m_pComponent
    && (BYTE5(m_pComponent[1].m_BoundComponentHandles.mNode.mPrev)
     || !BYTE6(m_pComponent[1].m_BoundComponentHandles.mNode.mPrev)
     || BYTE1(m_pComponent[1].m_BoundComponentHandles.mNode.mNext)) )
  {
    v5 = 0;
  }
LABEL_29:
  if ( mPrev == LocalPlayer
    || (v14 = (unsigned int)(vfptr - 34), (unsigned int)v14 > 0x35)
    || (v15 = 0x25000000001001i64, !_bittest64(&v15, v14)) )
  {
    if ( v5 )
      UFG::FaceMeterComponent::_ApplyEvent(this, (UFG::GameStatEventType)vfptr);
  }
}

// File Line: 515
// RVA: 0x563DC0
char __fastcall UFG::FaceMeterComponent::_UnapplyEvent(
        UFG::FaceMeterComponent *this,
        int eventType,
        UFG::qPropertySet *pPropertySet)
{
  UFG::ScoreAffector *v3; // rbx

  if ( !pPropertySet || eventType >= 107 )
    return 0;
  v3 = &this->mAffectors[eventType];
  if ( *UFG::qPropertySet::Get<bool>(
          pPropertySet,
          (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_Disabled,
          DEPTH_RECURSE) )
    return 0;
  v3->mIsActive = 0;
  v3->mTimestamp = UFG::Metrics::msInstance.mSimTimeMSec;
  return 1;
}

// File Line: 544
// RVA: 0x563840
char __fastcall UFG::FaceMeterComponent::_ApplyEvent(
        UFG::FaceMeterComponent *this,
        int eventType,
        UFG::qPropertySet *pPropertySet)
{
  __int64 v4; // rdi
  UFG::ScoreAffector *v6; // rbx
  UFG::qSymbol *v7; // rax
  UFG::qStaticSymbol *v8; // rcx
  float v9; // xmm7_4
  float *v10; // rax
  float *v11; // rcx
  float v12; // xmm6_4
  float mCurrentMultiplier; // xmm9_4
  float v14; // xmm0_4
  float v15; // xmm1_4
  float mMultiplierResetTimer; // xmm2_4
  char *v17; // r15
  float v18; // xmm1_4
  float v19; // xmm1_4
  UFG::GameStatTracker *v20; // rax
  __int64 v21; // rax
  int v22; // edx
  UFG::qString v24; // [rsp+38h] [rbp-90h] BYREF
  UFG::qSymbol faceadjustmenttype; // [rsp+E0h] [rbp+18h] BYREF
  int v26; // [rsp+E8h] [rbp+20h] BYREF

  v4 = eventType;
  if ( pPropertySet )
  {
    if ( eventType < 107 )
    {
      v6 = &this->mAffectors[eventType];
      if ( !*UFG::qPropertySet::Get<bool>(
               pPropertySet,
               (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_Disabled,
               DEPTH_RECURSE) )
      {
        v7 = UFG::qPropertySet::Get<UFG::qSymbol>(
               pPropertySet,
               (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_AdjustmentType,
               DEPTH_RECURSE);
        v8 = &qSymbol_Any;
        if ( v7 )
          v8 = (UFG::qStaticSymbol *)v7;
        faceadjustmenttype.mUID = v8->mUID;
        v6->mPoints = *UFG::qPropertySet::Get<float>(
                         pPropertySet,
                         (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_FaceAdjustment,
                         DEPTH_RECURSE);
        v6->mMultiplierReduction = *UFG::qPropertySet::Get<float>(
                                      pPropertySet,
                                      (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_MultiplierReduction,
                                      DEPTH_RECURSE);
        v6->mMultiplierResetTimer = *UFG::qPropertySet::Get<float>(
                                       pPropertySet,
                                       (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_MultiplierResetTimer,
                                       DEPTH_RECURSE);
        v9 = *(float *)&FLOAT_1_0;
        if ( UFG::Metrics::IsTimeScaled(&UFG::Metrics::msInstance) )
        {
          v26 = 1065353216;
          v10 = UFG::qPropertySet::Get<float>(
                  pPropertySet,
                  (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_MultiplierSlowMode,
                  DEPTH_RECURSE);
          v11 = (float *)&v26;
          if ( v10 )
            v11 = v10;
          v12 = *v11;
        }
        else
        {
          v12 = *(float *)&FLOAT_1_0;
        }
        UFG::GameStatAction::Player::RegisterSuccessFaceEvent(&faceadjustmenttype);
        this->mLastActionPerformedTimestamp = UFG::Metrics::msInstance.mSimTimeMSec;
        mCurrentMultiplier = v6->mCurrentMultiplier;
        v6->mIsActive = 1;
        v6->mTimestamp = UFG::Metrics::msInstance.mSimTimeMSec;
        v14 = mCurrentMultiplier - v6->mMultiplierReduction;
        if ( v14 <= 0.0 )
        {
          v14 = 0.0;
        }
        else
        {
          v15 = FLOAT_2_0;
          if ( v14 >= 2.0 )
          {
LABEL_16:
            v6->mCurrentMultiplier = v15;
            mMultiplierResetTimer = v6->mMultiplierResetTimer;
            if ( mMultiplierResetTimer <= 0.0 )
              v6->mMultiplierReplenishRate = 1.0;
            else
              v6->mMultiplierReplenishRate = (float)(1.0 - v15) / mMultiplierResetTimer;
            v17 = UFG::qPropertySet::Get<char const *>(
                    pPropertySet,
                    (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_XPFlasherCaption,
                    DEPTH_RECURSE);
            v18 = *UFG::qPropertySet::Get<float>(
                     pPropertySet,
                     (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_CopPoints,
                     DEPTH_RECURSE);
            if ( v18 < 0.0 )
              UFG::GameStatAction::MissionScoring::LogCopEvent(
                COP_FSR_MOVES,
                (int)(float)(mCurrentMultiplier * v18),
                &customCaption);
            v19 = *UFG::qPropertySet::Get<float>(
                     pPropertySet,
                     (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_TriadPoints,
                     DEPTH_RECURSE);
            if ( v19 > 0.0 )
              UFG::GameStatAction::MissionScoring::LogTriadEvent(
                TRIAD_FSR_MOVES,
                (int)(float)(mCurrentMultiplier * v19),
                v17);
            if ( UFG::IsAnyLocalPlayer((UFG::SimObjectCharacter *)this->m_pSimObject) )
              v9 = UFG::PlayerBuffTracker::GetFaceMeterEarnedMultiplier() + 1.0;
            v20 = UFG::GameStatTracker::Instance();
            if ( UFG::GameStatTracker::GetStat(v20, PlayerFaceMeterBuff_Activated) < 0.0 )
              UFG::GameStatAction::Player::ClampAndApplyDeltaCombatMeter(
                (float)((float)(v12 * v6->mPoints) * mCurrentMultiplier) * v9,
                faceadjustmenttype.mUID);
            UFG::qString::qString(&v24, "%d %s", (unsigned int)(int)v6->mPoints, UFG::GameStatEventStrings[v4]);
            UFG::qString::Set(
              &UFG::UIHKScreenHud::CombatMeter->mDebugFaceEventCaption,
              *(const char **)(v21 + 24),
              *(_DWORD *)(v21 + 20),
              0i64,
              0);
            UFG::qString::~qString(&v24);
            switch ( (_DWORD)v4 )
            {
              case 0x31:
                v22 = 1;
                break;
              case 0x2F:
                v22 = 2;
                break;
              case 0x32:
                v22 = 3;
                break;
              case 0x14:
                v22 = 4;
                break;
              case 0x46:
                v22 = 5;
                break;
              default:
                return 1;
            }
            UFG::UIHKCombatMeterWidget::PipsUsed(UFG::UIHKScreenHud::CombatMeter, v22);
            return 1;
          }
        }
        v15 = v14;
        goto LABEL_16;
      }
    }
  }
  return 0;
}

// File Line: 632
// RVA: 0x563750
char __fastcall UFG::FaceMeterComponent::_ApplyEvent(UFG::FaceMeterComponent *this, UFG::GameStatEventType eventType)
{
  UFG::qSymbol *v5; // r15
  UFG::qPropertySet *v6; // rdi
  UFG::qPropertyList *v7; // rax
  UFG::qPropertyList *v8; // rbp
  unsigned int mNumElements; // esi
  unsigned int v10; // ebx
  char *ValuePtr; // rax
  UFG::qPropertySet *v12; // rcx

  if ( eventType == GameStatEvent_Max )
    return 0;
  v5 = UFG::GameStatEventSymbols[eventType];
  v6 = 0i64;
  UFG::PropertySetHandle::Bind(&this->mProperties);
  v7 = UFG::qPropertySet::Get<UFG::qPropertyList>(
         this->mProperties.mpPropSet,
         (UFG::qArray<unsigned long,0> *)&FaceEventSymbol_Events,
         DEPTH_RECURSE);
  v8 = v7;
  if ( v7 )
  {
    mNumElements = v7->mNumElements;
    v10 = 0;
    if ( mNumElements )
    {
      while ( 1 )
      {
        ValuePtr = UFG::qPropertyList::GetValuePtr(v8, 0x1Au, v10);
        if ( ValuePtr && *(_QWORD *)ValuePtr )
          v12 = (UFG::qPropertySet *)&ValuePtr[*(_QWORD *)ValuePtr];
        else
          v12 = 0i64;
        if ( v5->mUID == v12->mName.mUID )
          break;
        if ( ++v10 >= mNumElements )
          return UFG::FaceMeterComponent::_ApplyEvent(this, eventType, v6);
      }
      v6 = v12;
    }
  }
  return UFG::FaceMeterComponent::_ApplyEvent(this, eventType, v6);
}

// File Line: 667
// RVA: 0x535660
bool __fastcall UFG::FaceMeterComponent::HasComponent(UFG::SceneObjectProperties *pSceneObj)
{
  UFG::qPropertySet *mpWritableProperties; // rcx

  mpWritableProperties = pSceneObj->mpWritableProperties;
  if ( !mpWritableProperties )
    mpWritableProperties = pSceneObj->mpConstProperties;
  return UFG::qPropertySet::GetParentFromName(
           mpWritableProperties,
           (UFG::qArray<unsigned long,0> *)&SimSymX_propset_componentFaceMeter,
           DEPTH_RECURSE) != 0i64;
}

// File Line: 673
// RVA: 0x544F40
UFG::FaceMeterComponent *__fastcall UFG::FaceMeterComponent::PropertiesOnActivate(
        UFG::SceneObjectProperties *pSceneObj)
{
  UFG::qMemoryPool *SimulationMemoryPool; // rax
  UFG::allocator::free_link *v3; // rax
  UFG::SimComponent *v4; // rax
  UFG::SimComponent *v5; // rbx
  UFG::SimObjectModifier v7; // [rsp+38h] [rbp-30h] BYREF

  SimulationMemoryPool = UFG::GetSimulationMemoryPool();
  v3 = UFG::qMemoryPool::Allocate(SimulationMemoryPool, 0x21E0ui64, "FaceMeterComponent", 0i64, 1u);
  if ( v3 )
  {
    UFG::FaceMeterComponent::FaceMeterComponent((UFG::FaceMeterComponent *)v3, pSceneObj->m_NameUID);
    v5 = v4;
  }
  else
  {
    v5 = 0i64;
  }
  UFG::SimObjectModifier::SimObjectModifier(&v7, pSceneObj->m_pSimObject, 1);
  UFG::SimObjectModifier::AttachComponent(&v7, v5, 0xFFFFFFFFi64);
  UFG::SimObjectModifier::Close(&v7);
  UFG::SimObjectModifier::~SimObjectModifier(&v7);
  return (UFG::FaceMeterComponent *)v5;
}

